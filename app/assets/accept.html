<p>If we could simulate Hamiltonian dynamics exactly, we would always accept the proposed positions. However, itâ€™s needed to account for numerical errors during integration with a Metropolis acceptance step. The probability of accepting the proposal <span class="math inline">(\boldsymbol{\theta}&#39;, \boldsymbol{v}&#39;)</span> generated by transitioning from <span class="math inline">(\boldsymbol{\theta}, \boldsymbol{v})</span> is</p>
<p><span class="math display">
\min(1, \exp\left(\mathcal{H}(\boldsymbol{\theta}, \boldsymbol{v}) - \mathcal{H}(\boldsymbol{\theta}&#39;, \boldsymbol{v}&#39;) \right))
</span></p>
<p>If this approximation is good, then <span class="math inline">\mathcal{H}(\boldsymbol{\theta}, \boldsymbol{v}) - \mathcal{H}(\boldsymbol{\theta}&#39;, \boldsymbol{v}&#39;)</span> would be small, and the acceptance rate will be high.</p>
